generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id           String    @id @default(cuid())
  email        String    @unique
  passwordHash String
  role         Role      @default(SALARIE)
  createdAt    DateTime  @default(now())
  employee     Employee?
}

model Employee {
  id         String     @id @default(cuid())
  userId     String?    @unique               // IMPORTANT : unique pour la relation 1â€“1
  user       User?      @relation(fields: [userId], references: [id])
  firstName  String
  lastName   String
  phone      String?
  address    String?
  status     Status     @default(ACTIF)
  avatarUrl  String?
  createdAt  DateTime   @default(now())
  timesheets Timesheet[]
}

model Timesheet {
  id                String   @id @default(cuid())
  employee          Employee @relation(fields: [employeeId], references: [id])
  employeeId        String
  declaredStart     DateTime
  declaredEnd       DateTime
  declaredBreakMins Int      @default(0)
  status            TStatus  @default(EN_ATTENTE)
  validatedByUserId String?
  validatedAt       DateTime?
  createdAt         DateTime @default(now())
}

enum Role {
  ADMIN
  MANAGER
  SALARIE
}

enum Status {
  ACTIF
  INACTIF
  EN_ATTENTE
}

enum TStatus {
  EN_ATTENTE
  VALIDE
  REFUSE
}
